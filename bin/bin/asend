#!/usr/bin/env ruby
require 'rubygems'
require 'fileutils'
require 'optparse'

AUDIO_FILES_DIR = "/home/m/Apps/pomodoro_sounds"
AUDIO_FILES = Dir["#{AUDIO_FILES_DIR}/*.mp3"].collect do |path|
  File.basename(path, ".mp3")
end

options = {
  "audio_file" => "jobs_done"
}
OptionParser.new do |opts|
  opts.banner = "Usage: asend [options]"

  opts.on("-l", "--list", "list all audio files") do
    puts AUDIO_FILES
    exit
  end

  opts.on("-a",
          "--audio-file audio_file",
          "specify which audio file should be played (default: jobs_done)") do |arg|
            options["audio_file"] = arg
          end
end.parse!

`send '#{ARGV[-1]}' && mplayer -volume 50 '#{AUDIO_FILES_DIR}/#{options["audio_file"]}.mp3' 2>&1 > /dev/null`
